// Generated by CIRCT firtool-1.62.0
module DoubleBuffer(
  input        clock,
               reset,
  output       io_enq_ready,
  input        io_enq_valid,
  input  [7:0] io_enq_bits,
  input        io_deq_ready,
  output       io_deq_valid,
  output [7:0] io_deq_bits
);

  reg  [1:0] stateReg;
  reg  [7:0] dataReg;
  reg  [7:0] shadowReg;
  wire       _io_deq_valid_T = stateReg == 2'h1;
  wire       _GEN = stateReg == 2'h1;
  wire       _GEN_0 = io_deq_ready & io_enq_valid;
  wire       _GEN_1 = ~io_deq_ready & io_enq_valid;
  wire       _GEN_2 = stateReg == 2'h2 & io_deq_ready;
  always @(posedge clock) begin
    if (reset)
      stateReg <= 2'h0;
    else if (|stateReg) begin
      if (_GEN) begin
        if (_GEN_1)
          stateReg <= 2'h2;
        else if (_GEN_0)
          stateReg <= 2'h1;
        else if (io_deq_ready & ~io_enq_valid)
          stateReg <= 2'h0;
      end
      else if (_GEN_2)
        stateReg <= 2'h1;
    end
    else if (io_enq_valid)
      stateReg <= 2'h1;
    if (|stateReg) begin
      if (_GEN) begin
        if (_GEN_0)
          dataReg <= io_enq_bits;
      end
      else if (_GEN_2)
        dataReg <= shadowReg;
    end
    else if (io_enq_valid)
      dataReg <= io_enq_bits;
    if ((|stateReg) & _GEN & _GEN_1)
      shadowReg <= io_enq_bits;
  end // always @(posedge)
  assign io_enq_ready = ~(|stateReg) | _io_deq_valid_T;
  assign io_deq_valid = _io_deq_valid_T | stateReg == 2'h2;
  assign io_deq_bits = dataReg;
endmodule

module DoubleBufferFifo(
  input        clock,
               reset,
  output       io_enq_ready,
  input        io_enq_valid,
  input  [7:0] io_enq_bits,
  input        io_deq_ready,
  output       io_deq_valid,
  output [7:0] io_deq_bits
);

  wire       _DoubleBuffer_1_io_enq_ready;
  wire       _DoubleBuffer_io_deq_valid;
  wire [7:0] _DoubleBuffer_io_deq_bits;
  DoubleBuffer DoubleBuffer (
    .clock        (clock),
    .reset        (reset),
    .io_enq_ready (io_enq_ready),
    .io_enq_valid (io_enq_valid),
    .io_enq_bits  (io_enq_bits),
    .io_deq_ready (_DoubleBuffer_1_io_enq_ready),
    .io_deq_valid (_DoubleBuffer_io_deq_valid),
    .io_deq_bits  (_DoubleBuffer_io_deq_bits)
  );
  DoubleBuffer DoubleBuffer_1 (
    .clock        (clock),
    .reset        (reset),
    .io_enq_ready (_DoubleBuffer_1_io_enq_ready),
    .io_enq_valid (_DoubleBuffer_io_deq_valid),
    .io_enq_bits  (_DoubleBuffer_io_deq_bits),
    .io_deq_ready (io_deq_ready),
    .io_deq_valid (io_deq_valid),
    .io_deq_bits  (io_deq_bits)
  );
endmodule

module DoubleBufferFifoTop(
  input        clock,
               reset,
  output       io_enq_ready,
  input        io_enq_valid,
  input  [7:0] io_enq_bits,
  input        io_deq_ready,
  output       io_deq_valid,
  output [7:0] io_deq_bits
);

  DoubleBufferFifo fifo (
    .clock        (clock),
    .reset        (reset),
    .io_enq_ready (io_enq_ready),
    .io_enq_valid (io_enq_valid),
    .io_enq_bits  (io_enq_bits),
    .io_deq_ready (io_deq_ready),
    .io_deq_valid (io_deq_valid),
    .io_deq_bits  (io_deq_bits)
  );
endmodule

